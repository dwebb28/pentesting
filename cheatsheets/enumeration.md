# Enumeration

### Wordlists

```
/usr/share/seclists
/usr/share/wfuzz
/usr/share/dirb
```

### gobuster
```
gobuster dir -u http://<ip> -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -x ".php,.html"
```
- use `--insecuressl` if necessary for https


### LDAP
- get dcs
```sh
ldapsearch -h <host> -x -s base namingcontexts
```
- get ldap dump
```sh
ldapsearch -h 10.129.1.77 -x -b "DC=htb,DC=local"
```
- get specific object classes
```sh
ldapsearch -h 10.129.1.77 -x -b "DC=htb,DC=local" '(objectClass=Person)'
```
- only account names
```sh
ldapsearch -h 10.129.1.77 -x -b "DC=htb,DC=local" '(objectClass=Person)' sAMAccountName
```

### SMB
- via rpcclient
```
rpcclient -U '' <ip>
```

## Active Directory

### Impacket
- lots of good impacket scripts


### Non Kerberos Preauthentication
```sh
GetNPUsers.py -dcip-ip <dc-ip> -request '<domain>/'
```

### Guessing Valid Users - kerbrute
```sh
./kerbrute userenum -d <domain> users.txt --dc <domain_controller>
```

## Brute Forcing

## wordlists

```
cewl -d 7 -m 8 -w cewl.out <site>
```
- m: minimum word length
- d: page depth
- w: write file

### hydra

#### http-post-form
```
hydra -l root -P /usr/share/seclists/Passwords/Common-Credentials/10-million-password-list-top-10000.txt <ip> http-post-form "<url>:user=^USER^&pw=^PASS^:<ERROR_TEXT>"
```

#### ssh
``
# hydra -l root -p admin <ip> -t 4 ssh`
``

#### smb
```
hydra -L users.txt -P pass.txt smb://<ip>
```
